<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Round 2: Mr. & Miss Birla</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; }
        body {
            margin: 0;
            height: 100vh;
            overflow: hidden;
            background-color: #050505;
            font-family: 'Outfit', sans-serif;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        /* THEME & BACKGROUND */
        .bg-layer {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            background-image: url('https://images.unsplash.com/photo-1570577568565-d4c3821a8d29?q=80&w=1920&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            filter: blur(16px) brightness(0.3);
            transform: scale(1.1);
        }

        /* TEXT STYLES */
        .top-tag {
            font-size: 0.9rem;
            letter-spacing: 4px;
            text-transform: uppercase;
            color: #FFD700;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .main-title {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            color: #fff;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
            margin: 0;
            line-height: 1.1;
        }

        .highlight { color: #FFD700; } /* Gold Color */

        .sub-title {
            font-size: 1.2rem;
            font-weight: 300;
            color: #ccc;
            margin-top: 10px;
            margin-bottom: 30px;
            font-family: 'Playfair Display', serif;
            font-style: italic;
        }

        /* TIMER */
        .timer-container {
            display: flex;
            gap: 20px;
            margin-bottom: 40px;
        }

        .time-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 60px;
        }

        .num {
            font-size: 2.5rem;
            font-weight: 600;
            color: #fff;
            line-height: 1;
            font-variant-numeric: tabular-nums;
        }

        .unit {
            font-size: 0.7rem;
            color: #FFD700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 5px;
            opacity: 0.8;
        }

        /* INTERACTIVE SECURITY AREA */
        #live-area { display: none; width: 100%; max-width: 400px; }

        .btn-vote {
            background: linear-gradient(45deg, #FFD700, #FDB931);
            border: none;
            padding: 15px 40px;
            color: #000;
            font-family: 'Outfit', sans-serif;
            font-weight: 700;
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
            transition: transform 0.2s;
            width: 80%;
        }

        .btn-vote:active { transform: scale(0.95); }
        .btn-vote:disabled { background: #555; color: #888; box-shadow: none; cursor: not-allowed; }

        .security-log {
            margin-top: 20px;
            font-size: 0.9rem;
            color: #aaa;
            background: rgba(0,0,0,0.5);
            padding: 10px;
            border-radius: 6px;
            display: none;
        }

        .status-success { color: #4caf50; }
        .status-fail { color: #f44336; }

        /* FOOTER INFO */
        .info-box {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 215, 0, 0.2);
            padding: 15px 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 350px;
            margin-top: 30px;
        }

        .info-label {
            color: #FFD700;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .security-badge {
            display: inline-block;
            font-size: 0.7rem;
            border: 1px solid #ff4444;
            color: #ff4444;
            padding: 2px 6px;
            border-radius: 4px;
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* MOBILE ADJUSTMENTS */
        @media (max-width: 480px) {
            .main-title { font-size: 2.8rem; }
            .num { font-size: 2rem; }
            .timer-container { gap: 15px; }
        }
    </style>
</head>
<body>

    <div class="bg-layer"></div>

    <div class="top-tag">THE FINAL SHOWDOWN</div>
    <h1 class="main-title">BKBNC <span class="highlight">2025</span></h1>
    <div class="sub-title">Round 2: Live Performance Voting</div>

    <div class="timer-container" id="countdown">
        <div class="time-box">
            <span class="num" id="d">00</span>
            <span class="unit">Days</span>
        </div>
        <div class="time-box">
            <span class="num" id="h">00</span>
            <span class="unit">Hrs</span>
        </div>
        <div class="time-box">
            <span class="num" id="m">00</span>
            <span class="unit">Mins</span>
        </div>
        <div class="time-box">
            <span class="num" id="s">00</span>
            <span class="unit">Secs</span>
        </div>
    </div>

    <div id="live-area">
        <button id="start-vote-btn" class="btn-vote" onclick="initiateVoting()">
            Enter Voting Arena
        </button>
        <div class="security-log" id="sec-log">
            Checking Device ID...
        </div>
    </div>

    <div class="info-box">
        <div class="info-label">Voting Schedule</div>
        <div style="font-size: 0.9rem; color: #ddd; line-height: 1.5;">
            24 Dec 2025<br>
            Live During Event Only
        </div>
        <div class="security-badge">
            <span style="font-size:1.2em">ðŸ”’</span> Geo-Fenced: Main Building
        </div>
    </div>

    <script>
        // --- 1. CONFIGURATION (EDIT THIS) ---
        const START_TIME = new Date("2025-12-24T18:00:00").getTime(); // Adjust Time
        const END_TIME   = new Date("2025-12-24T20:00:00").getTime(); 

        // COLLEGE COORDINATES (Get these from Google Maps)
        const COLLEGE_LAT = 19.2437; // Example Latitude (Change this!)
        const COLLEGE_LNG = 73.1355; // Example Longitude (Change this!)
        const ALLOWED_RADIUS_METERS = 500; // How far from building is allowed?

        // ------------------------------------

        const els = {
            d: document.getElementById('d'),
            h: document.getElementById('h'),
            m: document.getElementById('m'),
            s: document.getElementById('s'),
            timer: document.getElementById('countdown'),
            liveArea: document.getElementById('live-area'),
            voteBtn: document.getElementById('start-vote-btn'),
            log: document.getElementById('sec-log')
        };

        // --- TIMER LOGIC ---
        function tick() {
            const now = Date.now();

            if (now < START_TIME) {
                // Countdown
                const diff = START_TIME - now;
                els.d.innerText = String(Math.floor(diff / (1000 * 60 * 60 * 24))).padStart(2, '0');
                els.h.innerText = String(Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60))).padStart(2, '0');
                els.m.innerText = String(Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60))).padStart(2, '0');
                els.s.innerText = String(Math.floor((diff % (1000 * 60)) / 1000)).padStart(2, '0');
            } else if (now >= START_TIME && now < END_TIME) {
                // Live
                els.timer.style.display = 'none';
                els.liveArea.style.display = 'block';
            } else {
                // Ended
                els.timer.style.display = 'none';
                els.liveArea.style.display = 'block';
                els.voteBtn.disabled = true;
                els.voteBtn.innerText = "Voting Closed";
                els.voteBtn.style.background = "#333";
            }
        }
        setInterval(tick, 1000);
        tick();

        // --- SECURITY LOGIC ---

        function initiateVoting() {
            els.log.style.display = 'block';
            els.voteBtn.disabled = true; // Prevent clicks during check
            
            // 1. CHECK DEVICE (One per user)
            els.log.innerHTML = "Verifying Device integrity...";
            
            setTimeout(() => {
                if (localStorage.getItem('bkbnc_voted_r2')) {
                    failSecurity("Error: You have already voted on this device.");
                    return;
                }

                // 2. CHECK LOCATION (Geofencing)
                els.log.innerHTML = "Triangulating Location...<br>Please Allow GPS Access.";
                
                if (!navigator.geolocation) {
                    failSecurity("GPS not supported on this device.");
                } else {
                    navigator.geolocation.getCurrentPosition(successLoc, errorLoc);
                }
            }, 1000);
        }

        function successLoc(position) {
            const userLat = position.coords.latitude;
            const userLng = position.coords.longitude;
            
            // Calculate Distance (Haversine Formula)
            const R = 6371e3; // Earth radius in meters
            const Ï†1 = userLat * Math.PI/180;
            const Ï†2 = COLLEGE_LAT * Math.PI/180;
            const Î”Ï† = (COLLEGE_LAT-userLat) * Math.PI/180;
            const Î”Î» = (COLLEGE_LNG-userLng) * Math.PI/180;

            const a = Math.sin(Î”Ï†/2) * Math.sin(Î”Ï†/2) +
                      Math.cos(Ï†1) * Math.cos(Ï†2) *
                      Math.sin(Î”Î»/2) * Math.sin(Î”Î»/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            const distance = R * c; // Distance in meters

            if (distance <= ALLOWED_RADIUS_METERS) {
                // SUCCESS: Redirect to actual voting form
                els.log.innerHTML = `<span class="status-success">âœ“ Verified: Main Building (${Math.floor(distance)}m)</span><br>Redirecting...`;
                
                // Set flag so they can't verify again
                localStorage.setItem('bkbnc_voted_r2', 'true');
                
                // REDIRECT TO GOOGLE FORM OR VOTING PAGE HERE
                setTimeout(() => {
                    window.location.href = "YOUR_VOTING_FORM_LINK_HERE";
                }, 1500);
            } else {
                failSecurity(`Location Denied.<br>You are ${Math.floor(distance)}m away.<br>Access limited to Main Building.`);
            }
        }

        function errorLoc() {
            failSecurity("GPS Permission Denied.<br>Enable location to vote.");
        }

        function failSecurity(msg) {
            els.log.innerHTML = `<span class="status-fail">âš  ${msg}</span>`;
            els.voteBtn.innerText = "Access Denied";
            els.voteBtn.style.background = "#333";
            els.voteBtn.style.color = "#ff4444";
        }

    </script>
</body>
</html>
